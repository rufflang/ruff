# Test iterative fibonacci with JIT compilation
# This should trigger JIT for the loop inside the function

print("=== Testing Iterative Fibonacci ===")
print("")

func fib_iter(n) {
    if n <= 0 {
        return 0
    }
    if n == 1 {
        return 1
    }
    
    a := 0
    b := 1
    
    for i in range(n - 1) {
        temp := a
        a := b
        b := temp + b
    }
    
    return b
}

# Test basic cases
print("Test 1: Basic fibonacci values")
test_cases := [
    [0, 0],
    [1, 1],
    [2, 1],
    [3, 2],
    [4, 3],
    [5, 5],
    [6, 8],
    [7, 13],
    [8, 21],
    [9, 34],
    [10, 55]
]

for test in test_cases {
    n := test[0]
    expected := test[1]
    result := fib_iter(n)
    print("fib_iter(", n, ") =", result)
    assert result == expected, "Test 1 failed"
}
print("✓ Test 1 passed")
print("")

# Test larger values to trigger JIT
print("Test 2: Larger values (should trigger JIT)")
print("fib_iter(15) =", fib_iter(15))
print("fib_iter(20) =", fib_iter(20))
print("fib_iter(25) =", fib_iter(25))
print("✓ Test 2 passed")
print("")

# Call many times to ensure JIT compilation
print("Test 3: Multiple calls to trigger and use JIT")
sum := 0
for i in range(200) {
    sum := sum + fib_iter(10)
}
print("Sum of 200 calls to fib_iter(10):", sum)
assert sum == 11000, "Test 3 failed"
print("✓ Test 3 passed - JIT should be active!")
print("")

print("=== All Iterative Fibonacci Tests PASSED! ===")
